<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>文本 → CSV 转换器</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif}
  #wrap{display:flex;height:70vh}
  textarea{
    flex:1 1 50%;
    resize:none;
    padding:8px;
    border:1px solid #ccc;
    font-size:14px;
    line-height:1.4;
  }
  textarea:focus{outline:none;border-color:#007bff}
  h1{font-size:1.2rem;margin:8px;text-align:center}
  @media(max-width:600px){
    h1{font-size:1rem}
    textarea{font-size:13px}
  }
</style>
</head>
<body>
  <h1>原始文本（左） ↔ CSV（右）</h1>
  <div id="wrap">
    <textarea id="src" placeholder="请粘贴任意文本……"></textarea>
    <textarea id="csv" readonly placeholder="CSV 将在此显示……"></textarea>
  </div>

<script>
const src = document.getElementById('src');
const csv = document.getElementById('csv');

/* 实时转换 */
function sync() {
  const lines = src.value.trim().split(/\r?\n/);
  const rows  = [];
  for (let line of lines) {
    // 13 位：前 2 位字母或数字，后 11 位纯数字
    const m = line.match(/^([A-Za-z0-9]{2}\d{11})(?:\s|$)(.*)/);
    if (m) {
      const id   = m[1];
      const rest = m[2].replace(/\s+/g,' ').trim();
      rows.push([id, rest].map(escapeCSV).join(','));
    }
  }
  csv.value = rows.join('\n');
}

/* 转义 CSV 字段 */
function escapeCSV(str) {
  if (/[",\n]/.test(str)) return `"${str.replace(/"/g, '""')}"`;
  return str;
}

src.addEventListener('input', sync);
</script>
</body>
</html>
