<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>文本去重排序</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:Arial,Helvetica,sans-serif;padding:0px;display:flex;flex-direction:column;align-items:center}
.editor-wrapper {
    position: relative;
    width: 90%;
    max-width: 900px;
    height: 90vh;
    display: flex;
    flex-direction: column;
}
  .line-numbers{
    position:absolute;
    left:0;
    top:0;
    bottom:0;
    width:40px;
    background:#f5f5f5;
    border:1px solid #ccc;
    border-right:none;
    overflow:hidden;
    text-align:right;
    padding-right:5px;
    color:#666;
    font-size:14px;
    line-height:1.5;
    user-select:none;
  }
 textarea {
    flex: 1;
    padding: 5px 5px 5px 45px;
    resize: none;
    font-size: 16px;
    line-height: 1.5;
    border: 1px solid #ccc;
}
  .btn-row{display:flex;gap:20px;margin-top:10px;flex-wrap:wrap;justify-content:center}
  button{padding:8px 16px;font-size:16px;cursor:pointer}
</style>
</head>
<body>

<div class="editor-wrapper">
  <div class="line-numbers" id="lineNumbers"></div>
  <textarea id="inputText" placeholder="每行一条，可任意换行分隔"></textarea>
</div>

<div class="btn-row">
  <button onclick="clearText()">清空内容</button>
  <button onclick="processText()">排序、去重</button>
</div>

<script>
const STORAGE_KEY = 'textProcessorContent';
const ta   = document.getElementById('inputText');
const nums = document.getElementById('lineNumbers');

/* 更新行号 */
function updateLineNumbers(){
  const lineCount = ta.value.split('\n').length;
  nums.innerHTML = Array.from({length:lineCount},(_,i)=>i+1).join('<br>');
}
ta.addEventListener('input',  updateLineNumbers);
ta.addEventListener('input',  () => localStorage.setItem(STORAGE_KEY, ta.value)); // 实时保存
ta.addEventListener('scroll', ()=> nums.scrollTop = ta.scrollTop);

/* 初始加载 */
ta.value = localStorage.getItem(STORAGE_KEY) || '';
updateLineNumbers();

/* 排序 / 去重 / 13 位过滤 */
function processText(){
  const lines = ta.value
    .split('\n')
    .map(s=>s.trim())
    .filter(Boolean)
    .filter(s=>/^[a-zA-Z0-9]{2}\d{11}$/.test(s))
    .filter((v,i,a)=>a.indexOf(v)===i)
    .sort();
  ta.value = lines.join('\n');
  localStorage.setItem(STORAGE_KEY, ta.value);
  updateLineNumbers();
}

/* 清空确认 */
function clearText(){
  if(confirm('确定要清空所有内容吗？')){
    ta.value='';
    localStorage.removeItem(STORAGE_KEY);
    updateLineNumbers();
  }
}
</script>

</body>
</html>
